sampSib<-popSib[sample(1:N, n, replace=TRUE)]
hist(sampSib)
#plot log LH
#Poi(lam)
lam<-seq(0,6,length=100)
calcJdPo<-function(LAM, data=dat) {
return( sum(dpois(data, lambda=LAM, log=TRUE)))
#return( prod(dpois(data, lambda=LAM, log=FALSE)))
}
jdp1<-apply(as.matrix(lam),1,calcJdPo,data=sampSib)
plot(lam, jdp1, type="l", ylab=expression(paste("Log(Poisson(",lambda,"))")), xlab=expression(lambda))
#*** LOVE FOR MAC
#Population
popMac<-dat$macLove
X<- c(60,49,59,47,42,41,81,45)
var(X)
X<- c(2,7,7,4,5,1,3)
var(X)
X<- c(7.72,9.58,12.38,7.77,11.27,8.8,11.1,7.8,10.17,6)
var(X)
mean(X)
X<- c(60,49,59,47,42,41,81,45)
mean(X)
var(X)
sqrt(var(X))
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
sigma_squared <- 169
# Function to calculate log-likelihood
log_likelihood <- function(mu) {
return(-2 * log(2 * pi) - log(sigma_squared) - (1 / (2 * sigma_squared)) * sum((x - mu)^2))
}
# Generate values for mu
mu_values <- seq(35, 85, length.out = 100)  # Adjust the range based on your data
# Calculate log-likelihood for each mu
log_likelihood_values <- sapply(mu_values, log_likelihood)
# Plotting
plot(mu_values, log_likelihood_values, type = "l", col = "blue",
xlab = expression(mu), ylab = "Log-Likelihood",
main = expression("Log-Likelihood Function for " * mu * " with " * sigma^2 == 13^2))
grid()
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
#sigma_squared <- 169
mu = 50
# Function to calculate log-likelihood
log_likelihood <- function(sigma_squared) {
return(-2 * log(2 * pi) - log(sigma_squared) - (1 / (2 * sigma_squared)) * sum((x - mu)^2))
}
# Generate values for mu
sig_sqr_values <- seq(10,150, length.out = 100)  # Adjust the range based on your data
# Calculate log-likelihood for each mu
log_likelihood_values <- sapply(sig_sqr_values, log_likelihood)
# Plotting
plot(sig_sqr_values, log_likelihood_values, type = "l", col = "blue",
xlab = expression(sigma^2), ylab = "Log-Likelihood",
main = expression("Log-Likelihood Function for " * sigma^2 * " with " * mu == 50))
grid()
source("~/.active-rstudio-document")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
#sigma_squared <- 169
mu = 50
# Function to calculate log-likelihood
log_likelihood <- function(sigma_squared) {
return(-2 * log(2 * pi) - log(sigma_squared) - (1 / (2 * sigma_squared)) * sum((x - mu)^2))
}
# Generate values for mu
sig_sqr_values <- seq(10,150, length.out = 100)  # Adjust the range based on your data
# Calculate log-likelihood for each mu
log_likelihood_values <- sapply(sig_sqr_values, log_likelihood)
# Plotting
plot(sig_sqr_values, log_likelihood_values, type = "l", col = "blue",
xlab = expression(sigma^2), ylab = "Log-Likelihood",
main = expression("Log-Likelihood Function for " * sigma^2 * " with " * mu == 50))
grid()
```{r}
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
mu <- 50
# Function to calculate negative log-likelihood (since optimize finds minimum)
neg_log_likelihood <- function(sigma_squared) {
n <- length(x)
return(-( -n/2 * log(2 * pi * sigma_squared) - 1/(2 * sigma_squared) * sum((x - mu)^2) ))
}
# Use optimize to find the maximum
result <- optimize(neg_log_likelihood, interval = c(1, 200), maximum = TRUE)
# Extract the estimated value
estimated_sigma_squared <- result$minimum
# Print the result
cat("Estimated value for sigma^2:", estimated_sigma_squared, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
mu <- 50
# Function to calculate negative log-likelihood (since optimize finds minimum)
neg_log_likelihood <- function(sigma_squared) {
n <- length(x)
return(-( -n/2 * log(2 * pi * sigma_squared) - 1/(2 * sigma_squared) * sum((x - mu)^2) ))
}
# Use optimize to find the maximum
result <- optimize(neg_log_likelihood, interval = c(1, 200), maximum = TRUE)
# Extract the estimated value
estimated_sigma_squared <- result$minimum
# Print the result
cat("Estimated value for sigma^2:", estimated_sigma_squared, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
mu <- 50
# Function to calculate negative log-likelihood (since optimize finds minimum)
neg_log_likelihood <- function(sigma_squared) {
n <- length(x)
return(-(-n/2 * log(2 * pi * sigma_squared) - 1/(2 * sigma_squared) * sum((x - mu)^2)))
}
# Use optimize to find the minimum (negated maximum)
result <- optimize(neg_log_likelihood, interval = c(1, 200))
# Extract the estimated value
estimated_sigma_squared <- result$minimum
# Print the result
cat("Estimated value for sigma^2:", estimated_sigma_squared, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Function to calculate negative log-likelihood for mu (since optimize finds minimum)
neg_log_likelihood_mu <- function(mu) {
n <- length(x)
sigma_squared <- 132  # Assuming a specific value for sigma^2 (adjust as needed)
return(-(-n/2 * log(2 * pi * sigma_squared) - 1/(2 * sigma_squared) * sum((x - mu)^2)))
}
# Use optimize to find the minimum (negated maximum)
result_mu <- optimize(neg_log_likelihood_mu, interval = c(40, 60))  # Adjust interval as needed
# Extract the estimated value
estimated_mu <- result_mu$minimum
# Print the result
cat("Estimated value for mu:", estimated_mu, "\n")
var(x)
mean(x)
dat<- c(6,1,3,0,6,6,2,2)
n<-8
#*** Siblings
#Population
popSib<-dat$siblings
at<- c(6,1,3,0,6,6,2,2)
n<-8
#Data
set.seed(2222)
sampInd<-sample(dat, n, replace=TRUE)
sampSib<-popSib[sample(dat, n, replace=TRUE)]
hist(sampSib)
#Model: Pois(lam)
#plot log LH
#Poi(lam)
lam<-seq(0,6,length=100)
calcJdPo<-function(LAM, data=dat) {
return( sum(dpois(data, lambda=LAM, log=TRUE)))
#return( prod(dpois(data, lambda=LAM, log=FALSE)))
}
jdp1<-apply(as.matrix(lam),1,calcJdPo,data=dat)
plot(lam, jdp1, type="l", ylab=expression(paste("Log(Poisson(",lambda,"))")), xlab=expression(lambda))
x <- c(6, 1, 3, 0, 6, 6, 2, 2)
# Calculate the MLE for lambda
lambda_mle <- mean(x)
# Calculate the variance of the MLE
variance_mle <- lambda_mle
# Print the results
cat("MLE for lambda:", lambda_mle, "\n")
cat("Variance of MLE:", variance_mle, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Maximum Likelihood Estimate for mu
mu_hat <- mean(x)
# Maximum Likelihood Estimate for sigma^2
sigma_squared_hat <- mean((x - mu_hat)^2)
# Print the result
cat("Maximum Likelihood Estimate for sigma^2 (hat_sigma^2):", sigma_squared_hat, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Sample size
n <- length(x)
# Sample mean
x_bar <- mean(x)
# Sample standard deviation
s <- sd(x)
# Print the result
cat("Sample Standard Deviation (s):", s, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Sample size
n <- length(x)
# Sample mean
x_bar <- mean(x)
# Sample standard deviation
s <- sd(x)
# Z-score for a 95% confidence interval
z <- qnorm(0.975)
# Confidence interval for mu
ci_mu <- c(x_bar - z * (s / sqrt(n)), x_bar + z * (s / sqrt(n)))
# Critical values for chi-square distribution
chi_sq_lower <- qchisq(0.025, df = n - 1)
chi_sq_upper <- qchisq(0.975, df = n - 1)
# Confidence interval for sigma^2
ci_sigma_squared <- c(((n - 1) * s^2) / chi_sq_upper, ((n - 1) * s^2) / chi_sq_lower)
# Print the results
cat("95% Confidence Interval for mu:", ci_mu, "\n")
cat("95% Confidence Interval for sigma^2:", ci_sigma_squared, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Sample size
n <- length(x)
# Sample mean
x_bar <- mean(x)
# Sample standard deviation
s <- sd(x)
# Z-score for a 95% confidence interval
z <- qnorm(0.975)
# Confidence interval for mu
ci_mu <- c(x_bar - z * (s / sqrt(n)), x_bar + z * (s / sqrt(n)))
# Print the result
cat("95% Confidence Interval for mu:", ci_mu, "\n")
z
z
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Sample size
n <- length(x)
# Sample mean
x_bar <- mean(x)
# Sample standard deviation
s <- sd(x)
# Z-score for a 95% confidence interval
z <- qnorm(0.975)
# Confidence interval for mu
ci_mu <- c(x_bar - z * (s / sqrt(n)), x_bar + z * (s / sqrt(n)))
# Print the corrected result
cat("95% Confidence Interval for mu:", ci_mu, "\n")
x <- c(60, 49, 59, 47, 42, 41, 81, 45)
# Sample size
n <- length(x)
# Sample variance
s_squared <- var(x)
# Degrees of freedom
df <- n - 1
# Chi-square critical values
chi_sq_lower <- qchisq(0.025, df)
chi_sq_upper <- qchisq(0.975, df)
# Confidence interval for sigma^2
ci_sigma_squared <- c((df * s_squared) / chi_sq_upper, (df * s_squared) / chi_sq_lower)
# Print the result
cat("95% Confidence Interval for sigma^2:", ci_sigma_squared, "\n")
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- c(homework = c(100,98,97,83,101,98,97), quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 71) #midterm2 = 80, final_exam = 92)
#Question 2
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
if (!is.na(final_exam)) {
# Calculate weighted average with the final exam
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
midterm1 * weight_midterm1 +
midterm2 * weight_midterm2 +
final_exam * weight_final_exam)
} else {
# Handle the case when the final exam grade is not available
cat("Warning: Final exam grade is not available. Calculating weighted average without it.\n")
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
midterm1 * weight_midterm1)
# midterm2 * weight_midterm2)
}
# Return the overall grade
return(weighted_average)
}
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- c(homework = c(100,98,97,83,101,98,97), quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 71) #midterm2 = 80, final_exam = 92)
your_weighted_grade <- calculate_weighted_grade(your_scores[["homework"]],
your_scores[["quizzes"]],
your_scores[["midterm1"]],
your_scores[["midterm2"]],
your_scores[["final_exam"]])
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
ifelse(!is.na(midterm1), midterm1 * weight_midterm1, 0) +
ifelse(!is.na(midterm2), midterm2 * weight_midterm2, 0) +
ifelse(!is.na(final_exam), final_exam * weight_final_exam, 0))
# Return the overall grade
return(weighted_average)
}
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- c(homework = c(100,98,97,83,101,98,97, quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 75, midterm2 = NA, final_exam = NA)
your_weighted_grade <- calculate_weighted_grade(your_scores[["homework"]],
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
ifelse(!is.na(midterm1), midterm1 * weight_midterm1, 0) +
ifelse(!is.na(midterm2), midterm2 * weight_midterm2, 0) +
ifelse(!is.na(final_exam), final_exam * weight_final_exam, 0))
# Return the overall grade
return(weighted_average)
}
midterm1 = 75, midterm2 = NA, final_exam = NA)
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- c(homework = c(100,98,97,83,101,98,97), quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 71, midterm2 = NA, final_exam = NA)
your_weighted_grade <- calculate_weighted_grade(your_scores[["homework"]],
your_scores[["quizzes"]],
your_scores[["midterm1"]],
your_scores[["midterm2"]],
your_scores[["final_exam"]])
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- c(homework = c(100,98,97,83,100,98,97), quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 71, midterm2 = NA, final_exam = NA)
your_weighted_grade <- calculate_weighted_grade(your_scores[["homework"]],
your_scores[["quizzes"]],
your_scores[["midterm1"]],
your_scores[["midterm2"]],
your_scores[["final_exam"]])
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- list(homework = c(100,98,97,83,101,98,97), quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 75, midterm2 = NA, final_exam = NA)
your_weighted_grade <- calculate_weighted_grade(your_scores$homework,
your_scores$quizzes,
your_scores$midterm1,
your_scores$midterm2,
your_scores$final_exam)
cat("Your weighted average grade without dropping the lowest quiz and homework is:", round(your_weighted_grade, 2), "\n")
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
ifelse(!is.na(midterm1), midterm1 * weight_midterm1, 0) +
ifelse(!is.na(midterm2), midterm2 * weight_midterm2, 0) +
ifelse(!is.na(final_exam), final_exam * weight_final_exam, 0))
# Return the overall grade
return(weighted_average)
}
# Example usage:
# Replace 'your_scores' with your actual scores for each category
your_scores <- list(homework = c(100,98,97,83,101,98,97), quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 71, midterm2 = NA, final_exam = NA)
your_weighted_grade <- calculate_weighted_grade(your_scores$homework,
your_scores$quizzes,
your_scores$midterm1,
your_scores$midterm2,
your_scores$final_exam)
cat("Your weighted average grade without dropping the lowest quiz and homework is:", round(your_weighted_grade, 2), "\n")
# Replace these scores with your actual scores
your_scores <- list(homework = c(100,98,97,83,101,98,97),
quizzes = c(85.7,100,100,83.33,83.33,80,85.7,66.67,75),
midterm1 = 71,  # Replace this with your actual score
midterm2 = NA,
final_exam = NA)
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
ifelse(!is.na(midterm1), midterm1 * weight_midterm1, 0) +
ifelse(!is.na(midterm2), midterm2 * weight_midterm2, 0) +
ifelse(!is.na(final_exam), final_exam * weight_final_exam, 0))
# Return the overall grade
return(weighted_average)
}
# Calculate your weighted grade
your_weighted_grade <- calculate_weighted_grade(your_scores$homework,
your_scores$quizzes,
your_scores$midterm1,
your_scores$midterm2,
your_scores$final_exam)
cat("Your weighted average grade without dropping the lowest quiz and homework is:", round(your_weighted_grade, 2), "\n")
# Replace these scores with your actual scores
your_scores <- list(homework = c(100, 98, 97, 83, 101, 98, 97),
quizzes = c(85.7, 100, 100, 83.33, 83.33, 80, 85.7, 66.67, 75),
midterm1 = 71,
midterm2 = NA,
final_exam = NA)
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
ifelse(!is.na(midterm1), midterm1 * weight_midterm1, 0) +
ifelse(!is.na(midterm2), midterm2 * weight_midterm2, 0) +
ifelse(!is.na(final_exam), final_exam * weight_final_exam, 0))
# Return the overall grade
return(weighted_average)
}
# Calculate your weighted grade
your_weighted_grade <- calculate_weighted_grade(your_scores$homework,
your_scores$quizzes,
your_scores$midterm1,
your_scores$midterm2,
your_scores$final_exam)
cat("Your weighted average grade without dropping the lowest quiz and homework is:", round(your_weighted_grade, 2), "\n")
# Replace these scores with your actual scores
your_scores <- list(homework = c(100, 98, 97, 83, 101, 98, 97),
quizzes = c(85.7, 100, 100, 83.33, 83.33, 80, 85.7, 66.67, 75),
midterm1 = 71,
midterm2 = NA,
final_exam = NA)
# Function to calculate weighted grade without dropping lowest quiz and homework grades
calculate_weighted_grade <- function(homework, quizzes, midterm1, midterm2, final_exam) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm1 <- 0.25  # Corrected from 0.25 to 0.20
weight_midterm2 <- 0.25
weight_final_exam <- 0.30
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
ifelse(!is.na(midterm1), midterm1 * weight_midterm1, 0) +
ifelse(!is.na(midterm2), midterm2 * weight_midterm2, 0) +
ifelse(!is.na(final_exam), final_exam * weight_final_exam, 0))
# Return the overall grade
return(weighted_average)
}
# Calculate your weighted grade
your_weighted_grade <- calculate_weighted_grade(your_scores$homework,
your_scores$quizzes,
your_scores$midterm1,
your_scores$midterm2,
your_scores$final_exam)
cat("Your weighted average grade without dropping the lowest quiz and homework is:", round(your_weighted_grade, 2), "\n")
# Replace these scores with your actual scores
your_scores <- list(homework = c(100, 98, 97, 83, 101, 98, 97),
quizzes = c(85.7, 100, 100, 83.33, 83.33, 80, 85.7, 66.67, 75),
midterm = 71)
# Function to calculate weighted grade with specified weightings (without final exam)
calculate_weighted_grade <- function(homework, quizzes, midterm) {
# Assign weights
weight_homework <- 0.10
weight_quizzes <- 0.10
weight_midterm <- 0.25
# Calculate weighted average
weighted_average <- (mean(homework) * weight_homework +
mean(quizzes) * weight_quizzes +
midterm * weight_midterm)
# Return the overall grade
return(weighted_average)
}
# Calculate your weighted grade
your_weighted_grade <- calculate_weighted_grade(your_scores$homework,
your_scores$quizzes,
your_scores$midterm)
cat("Your weighted average grade without considering the final exam is:", round(your_weighted_grade, 2), "\n")
# Install and load ggplot2 if not already done
if (!requireNamespace("ggplot2", quietly = TRUE)) {
install.packages("ggplot2")
}
library(ggplot2)
# Create a sample data frame
set.seed(123)
data <- data.frame(
x = rnorm(100),
y = rnorm(100),
size = runif(100, 1, 10),
color_var = rnorm(100)
)
# Create the bubble plot with a color gradient
ggplot(data, aes(x = x, y = y)) +
geom_point(aes(size = size, color = color_var)) +
scale_color_gradient(low = "blue", high = "red") +
theme_minimal() +
labs(
title = "Bubble Plot with Color Gradient",
x = "X Axis",
y = "Y Axis",
color = "Color Variable",
size = "Bubble Size"
)
install.packages("ggcorrplot")
install.packages("ape")
install.packages("stringr")
setwd("~/02-601_Project_Fall2025")
shiny::runApp('ShinyApp')
